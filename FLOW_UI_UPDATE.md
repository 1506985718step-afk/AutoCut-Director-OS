# Flow-Based UI Update

## 概述

完成了用户友好的流程式 UI 设计，隐藏技术细节，提供直观的 4 步剪辑流程。

## 更新内容

### 1. 新 UI 文件
- `app/static/app.html` - 流程式用户界面（4 步骤）
- `app/static/style.css` - 现代化样式设计
- `app/static/app.js` - 前端逻辑 + API 集成

### 2. 路由更新 (`app/main.py`)
- `/` - 返回新的用户 UI (`app.html`)
- `/app` - 用户界面入口
- `/admin` - 重定向到 `/docs`（Swagger UI）
- `/docs` - API 文档（仅供开发者）

### 3. UI 设计理念

#### 步骤 1: 上传配置
- 拖拽上传视频
- 选择目标平台（抖音/B站/YouTube/快手）
- 选择视频风格（爆款/教学/情感/Vlog）
- **开始 AI 剪辑** 按钮

#### 步骤 2: 处理中
- 时间线式进度展示：
  - ✓ 视频已导入
  - ▶ 音频分析中
  - ○ 场景拆分
  - ○ AI 生成剪辑方案
  - ○ 自动剪辑
- 进度条 + 已用时 + 预计剩余时间
- 可折叠的详细日志（高级）
- **不显示 job_id**
- **不显示 API 名称**

#### 步骤 3: 预览 & 修改
- 视频预览播放器
- 剪辑方案摘要：
  - 开头 Hook
  - 节奏
  - BGM
  - 总时长
- 意图式调整按钮：
  - 🔥 Hook 更狠 / 💝 Hook 更温和
  - ⚡ 节奏更快 / 🐢 节奏更慢
  - 🎵 换一首音乐
  - 📝 字幕更大
- **用户调整的是意图，不是 DSL**
- 系统内部重新生成 DSL 并执行

#### 步骤 4: 导出 & 管理
- 选择导出质量（1080p / 4K）
- 下载成片
- 历史版本管理
- 删除项目 / 创建新项目

### 4. API 集成

#### 已集成的 API
- `POST /api/ingest/` - 上传视频 + 提取音频
- `GET /api/jobs/{job_id}` - 获取 job 状态
- `GET /api/jobs/{job_id}/preview` - 获取预览视频

#### 待集成的 API（TODO）
- `POST /api/llm/generate-dsl` - AI 生成剪辑方案
- `POST /api/execute/run` - 执行剪辑
- 意图式调整 API（需要新增）

### 5. 技术细节隐藏

#### 对用户隐藏
- ❌ job_id（内部使用）
- ❌ API 端点名称
- ❌ DSL 结构
- ❌ 技术错误信息

#### 对用户展示
- ✅ 简单的步骤名称
- ✅ 友好的进度提示
- ✅ 意图式调整选项
- ✅ 可理解的摘要信息

### 6. 开发者访问

- Swagger UI 移至 `/admin` 或 `/docs`
- 仅供开发者和高级用户使用
- 不在主 UI 中暴露

## 使用方法

### 启动服务器
```bash
cd autocut-director
python run_server.py
```

### 访问 UI
- 用户界面: http://localhost:8787/
- 管理界面: http://localhost:8787/admin
- API 文档: http://localhost:8787/docs

## 下一步工作

### 1. 完善 API 集成
- [ ] 集成 ASR（Whisper）API
- [ ] 集成场景检测 API
- [ ] 集成 LLM 生成 DSL API
- [ ] 集成 Resolve 执行 API

### 2. 实现意图式调整
- [ ] 设计意图调整 API
- [ ] 实现 DSL 重新生成逻辑
- [ ] 实现增量执行（只更新变化部分）

### 3. 优化用户体验
- [ ] 添加加载动画
- [ ] 优化错误提示
- [ ] 添加进度实时更新（WebSocket）
- [ ] 添加预览视频缓存

### 4. 测试
- [ ] 端到端测试完整流程
- [ ] 测试各种视频格式
- [ ] 测试不同平台和风格
- [ ] 测试意图调整功能

## 文件清单

### 新增文件
- `app/static/app.html` - 用户 UI
- `app/static/style.css` - 样式
- `app/static/app.js` - 前端逻辑
- `FLOW_UI_UPDATE.md` - 本文档

### 修改文件
- `app/main.py` - 路由更新

### 保留文件
- `app/static/index.html` - 旧版 UI（可删除）

## 设计原则

1. **用户视角** - 用户看到的是"我想要什么"，不是"系统怎么做"
2. **流程导向** - 线性 4 步流程，清晰明确
3. **意图优先** - 用户表达意图，系统负责实现
4. **技术隐藏** - 技术细节对用户不可见
5. **开发友好** - 开发者仍可通过 `/admin` 访问完整 API

## 版本信息

- **版本**: v1.4.0
- **日期**: 2026-02-05
- **状态**: 基础 UI 完成，API 集成进行中
